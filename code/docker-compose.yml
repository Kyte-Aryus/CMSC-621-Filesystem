version: "3.8"

services:

  node0:
    image: fsnode
    ports:
      - 8880:8880
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      RABBITMQ_ERLANG_COOKIE: cookiemonster
      RABBITMQ_NODENAME: rabbit@node0
      VERSION_ID_FILE: /opt/versionIds.txt
      NODE_COUNT: 5
    privileged: true

  node1:
    image: fsnode
    ports:
      - 8881:8881
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      RABBITMQ_ERLANG_COOKIE: cookiemonster
      RABBITMQ_NODENAME: rabbit@node1
      VERSION_ID_FILE: /opt/versionIds.txt
      NODE_COUNT: 5
    privileged: true

  node2: 
    image: fsnode
    ports:
      - 8882:8882
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      RABBITMQ_ERLANG_COOKIE: cookiemonster
      RABBITMQ_NODENAME: rabbit@node2
      VERSION_ID_FILE: /opt/versionIds.txt
      NODE_COUNT: 5
    privileged: true

  node3: 
    image: fsnode
    ports:
      - 8883:8883
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      RABBITMQ_ERLANG_COOKIE: cookiemonster
      RABBITMQ_NODENAME: rabbit@node3
      VERSION_ID_FILE: /opt/versionIds.txt
      NODE_COUNT: 5
    privileged: true

  node4: 
    image: fsnode
    ports:
      - 8884:8884
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      RABBITMQ_ERLANG_COOKIE: cookiemonster
      RABBITMQ_NODENAME: rabbit@node4
      VERSION_ID_FILE: /opt/versionIds.txt
      NODE_COUNT: 5
    privileged: true

  manager:
    image: rabbitmq:3-management
    ports:
      - 15672:15672 
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      RABBITMQ_ERLANG_COOKIE: cookiemonster
      RABBITMQ_NODENAME: rabbit@manager
